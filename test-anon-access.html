<!DOCTYPE html>
<html>
<head>
  <title>Test Supabase Anon Access</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
  <h1>–¢–µ—Å—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ users —Å anon –∫–ª—é—á–æ–º</h1>
  <button onclick="testAccess()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø</button>
  <pre id="result"></pre>

  <script>
    const supabaseUrl = 'https://ihivunmndpsysxdtedti.supabase.co';
    const anonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImloaXZ1bm1uZHBzeXN4ZHRlZHRpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk3Nzg0OTksImV4cCI6MjA4NTM1NDQ5OX0.yyPVXLtFQnDl1DmcnUREcXIFrLVP-4VSGGO2qzzfAdo';
    
    const supabase = window.supabase.createClient(supabaseUrl, anonKey);

    async function testAccess() {
      const result = document.getElementById('result');
      result.textContent = '–ü—Ä–æ–≤–µ—Ä–∫–∞...\n';

      try {
        // –¢–µ—Å—Ç 1: –ü—Ä–æ—Å—Ç–æ–π –∑–∞–ø—Ä–æ—Å
        result.textContent += '\n1Ô∏è‚É£ –¢–µ—Å—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞...\n';
        const { data: test1, error: error1 } = await supabase
          .from('users')
          .select('*')
          .limit(1);
        
        if (error1) {
          result.textContent += `‚ùå –û—à–∏–±–∫–∞: ${JSON.stringify(error1, null, 2)}\n`;
        } else {
          result.textContent += `‚úÖ –£—Å–ø–µ—Ö! –ù–∞–π–¥–µ–Ω–æ –∑–∞–ø–∏—Å–µ–π: ${test1?.length || 0}\n`;
        }

        // –¢–µ—Å—Ç 2: –ó–∞–ø—Ä–æ—Å —Å —Ñ–∏–ª—å—Ç—Ä–æ–º
        result.textContent += '\n2Ô∏è‚É£ –¢–µ—Å—Ç –∑–∞–ø—Ä–æ—Å–∞ —Å —Ñ–∏–ª—å—Ç—Ä–æ–º...\n';
        const userId = '762eb16b-154c-4845-b66b-e2d820170829';
        const { data: test2, error: error2 } = await supabase
          .from('users')
          .select('*')
          .eq('id', userId)
          .maybeSingle();
        
        if (error2) {
          result.textContent += `‚ùå –û—à–∏–±–∫–∞: ${JSON.stringify(error2, null, 2)}\n`;
        } else {
          result.textContent += `‚úÖ –£—Å–ø–µ—Ö! –î–∞–Ω–Ω—ã–µ: ${JSON.stringify(test2, null, 2)}\n`;
        }

        // –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ RLS
        result.textContent += '\n3Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ RLS —Å—Ç–∞—Ç—É—Å–∞...\n';
        result.textContent += '–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤—ã—à–µ, –∑–Ω–∞—á–∏—Ç RLS –æ—Ç–∫–ª—é—á–µ–Ω –∏–ª–∏ –ø–æ–ª–∏—Ç–∏–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ.\n';

      } catch (err) {
        result.textContent += `\nüí• –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: ${err.message}\n`;
        console.error(err);
      }
    }
  </script>
</body>
</html>
